// Generated by CoffeeScript 2.0.0-alpha1
(function() {
  var Start, body, cntmnu, commands, dir, error, head, loader, log, txt;
  log = console.log, error = console.error, dir = console.dir;
  body = document.body, head = document.head;
  commands = {};
  txt = pen("p").Html("loading...");
  loader = pen("div").Class("loader").Append(txt).AppendTo(body);
  cntmnu = function(e) {
    var Remove, addCommand, cntmn, removeCommand;
    e.preventDefault();
    cntmn = pen("div").Class("contextmenu").Css({
      top: `${e.clientY}px`,
      left: `${e.clientX}px`
    });
    addCommand = function(view, event) {
      commands[view] = {
        el: pen("span").Html(view).Class("contextmenu-command").On("click", event),
        hr: pen("hr").Class("contextmenu-divider")
      };
      pen(cntmn).Append(commands[view].el, commands[view].hr);
      return addCommand;
    };
    removeCommand = function(name) {
      pen(commands[name].el).Remove();
      pen(commands[name].hr).Remove();
      delete commands[name];
      return removeCommand;
    };
    Remove = function() {
      var name;
      for (name in commands) {
        removeCommand(name);
      }
      pen(cntmn).Remove();
      window.removeEventListener("click", Remove);
    };
    window.addEventListener("click", Remove);
    addCommand("reload", function() {
      return location.reload();
    });
    pen(cntmn).AppendTo(body);
    return cntmn;
  };
  Start = function(e) {
    var closer, header, title;
    window.addEventListener("contextmenu", cntmnu);
    header = pen("div").Class("header-title");
    title = pen("span").Class("title").Html(document.title);
    closer = pen("span").Class("header-button Ril").Html("X");
    pen(header).Append(title, closer).AppendTo(body);
    pen(loader).Remove();
    return log(`load took ${Math.round(e.timeStamp)} second(s)`);
  };
  return window.onload = Start;
})();
