// Generated by CoffeeScript 2.0.0-alpha1
var Card, Modal, Start, body, contextmenu, dir, error, head, header, load, log;

log = console.log, error = console.error, dir = console.dir;

body = document.body, head = document.head;

load = pen("p").Css({
  bottom: 0,
  right: 0,
  position: 'fixed',
  color: 'grey'
}).returnElement();

pen(load).AppendTo(body);

pen(load).Html("loading...");

Card = class Card {
  constructor(title, message) {
    this.container = pen("div").Class("card-container").returnElement();
    this.titleContainer = pen("div").Class("card-title-container").returnElement();
    this.messageContainer = pen("div").Class("card-message-container").returnElement();
    this.message = pen("span").Class("card-message").Html(title !== null ? title : '').returnElement();
    this.title = pen("span").Class("card-title").Html(message !== null ? message : '').returnElement();
    pen(this.titleContainer).Append(this.title);
    pen(this.messageContainer).Append(this.message);
    pen(this.container).Append(this.titleContainer, this.messageContainer);
  }

  setTitle(str) {
    pen(this.title).Html(str);
    return this;
  }

  setMessage(str) {
    pen(this.message).Html(str);
    return this;
  }

  Style(els, stroobj) {
    var el;
    if (pen.Type(els) === 'object') {
      for (el in els) {
        pen(this[el]).Css(els[el]);
      }
    } else {
      pen(this[el]).Css(stroobj);
    }
    return this;
  }

  deploy(el) {
    if (el != null) {
      pen(el).Append(this.container);
    } else {
      pen(body).Append(this.container);
    }
    return this;
  }

};

Modal = class Modal {
  constructor(headstr, bodystr, footstr) {
    var Remove;
    this.container = pen("div").Class("modal-container");
    this.head = pen("div").Class("modal-head");
    this.body = pen("div").Class("modal-body");
    this.foot = pen("div").Class("modal-foot");
    this.closebtn = pen("span").Class("close-button").Html("X");
    Remove = function(e) {
      pen(this.container).Remove();
      pen(this.closebtn).removeEventListener("click", Remove);
    };
    pen(this.closebtn).On("click", Remove);
    this.headText = pen("h2").Class("modal-head-text").Html(headerstr !== null ? headerstr : '');
    this.bodyText = pen("p").Class("modal-body-text").Html(bodystr !== null ? bodystr : '');
    this.footText = pen("h2").Class("modal-foot-text").Html(footstr !== null ? footstr : '');
    return this;
  }

  setHeadText(str) {
    pen(this.headText).Html(str);
    return this;
  }

  setBodyText(str) {
    pen(this.bodyText).Html(str);
    return this;
  }

  setFootText(str) {
    pen(this.footText).Html(str);
    return this;
  }

  Style(els, stroobj) {
    var el;
    if (pen.Type(el) === 'object') {
      for (el in els) {
        pen(this[el]).Css(els[el]);
      }
    } else {
      pen(this[el]).Css(stroobj);
    }
    return this;
  }

  deploy(el) {
    if (el != null) {
      pen(el).Append(this.container);
    } else {
      pen(body).Append(this.container);
    }
    return this;
  }

};

contextmenu = {
  commands: {},
  menu: pen("div").Class("contextmenu").attr("align", "center").returnElement(),
  addCommand: function(name, ev) {
    var self;
    self = contextmenu;
    self.commands[name] = {
      el: pen("span").Html(name).Class("contextmenu-command").On("click", ev).returnElement(),
      hr: pen("hr").Class("contextmenu-divider").returnElement()
    };
    return self;
  },
  removeCommand: function(name) {
    var self;
    self = contextmenu;
    pen(self.commands[name].el).Remove();
    pen(self.commands[name].hr).Remove();
    return self;
  },
  remove: function() {
    var name, self;
    self = contextmenu;
    for (name in self.commands) {
      self.removeCommand(name);
    }
    return removeEventListener("click", self.remove);
  },
  init: function(e) {
    var name, self;
    self = contextmenu;
    pen(self.menu).Css({
      top: `${e.clientY}px`,
      left: `${e.clientX}px`
    });
    for (name in self.commands) {
      pen(self.menu).Append(self.commands[name].el, self.commands[name].hr);
    }
    addEventListener("click", self.remove);
    pen(body).Append(self.menu);
    return self;
  }
};

header = {
  buttons: {},
  head: pen("div").Class("header").returnElement(),
  title: pen("span").Class("title").Html(document.title).returnElement(),
  addButton: function(name, event, el) {
    var self;
    self = header;
    if (el != null) {
      if (el === 'a') {
        self.buttons[name] = pen("a").Class("header-button Ril link").Html(name).attr("href", event).returnElement();
      } else {
        self.buttons[name] = pen(el).Class("header-button Ril").Html(name).On("click", event).returnElement();
      }
    } else {
      self.buttons[name] = pen("span").Class("header-button Ril").Html(name).On("click", event).returnElement();
    }
    return self;
  },
  removeButton: function(name) {
    var self;
    self = header;
    pen(self.buttons[name]).Remove();
    return self;
  },
  init: function() {
    var brs, i, j, name, self;
    self = header;
    pen(self.head).Append(self.title);
    for (name in self.buttons) {
      pen(self.head).Append(self.buttons[name]);
    }
    pen(body).Append(self.head);
    brs = [];
    for (i = j = 0; j <= 4; i = ++j) {
      brs[i] = pen("br").returnElement();
      pen(body).Append(brs[i]);
    }
    return self;
  }
};

Start = function(e) {
  var init, maincontain, mouseCl, mouseOu, mouseOv;
  contextmenu.addCommand("reload", (e) => {
    e.preventDefault();
    pen(load).Html("reloading...");
    return location.reload();
  }).addCommand("go back", (e) => {
    e.preventDefault();
    pen(load).Html("going back...");
    return location.back();
  }).addCommand("go forward", (e) => {
    e.preventDefault();
    pen(load).Html("going foward...");
    return location.forward();
  });
  addEventListener("contextmenu", (e) => {
    e.preventDefault();
    contextmenu.init(e);
  });
  header.addButton("<img src='blob/master/GitHub-Mark-64px.png' alt='Github mark'></img>", "https://github.com/Monochromefx/pen", "a").init();
  maincontain = pen("div").attr("align", "center").Class("wrapper").returnElement();
  init = `load took ${Math.round(e.timeStamp)} second(s)`;
  mouseOv = function(e) {
    pen(this).Html("want to remove this message?, if so just click me");
  };
  mouseOu = function(e) {
    pen(this).Html(init);
  };
  mouseCl = function(e) {
    return pen(this).Remove();
  };
  pen(load).Html(init);
  log(init);
  pen(load).On("mouseover", mouseOv);
  pen(load).On("mouseout", mouseOu);
  return pen(load).On("click", mouseCl);
};

window.onload = Start;
